/*┏┓　　　┏┓
┏┛┻━━━┛┻┓
┃　　　　　　　┃    ***** JavaScript Document
┃　　　━　　　┃    ***** 宅小歪 活动专题基础类
┃　┳┛　┗┳　┃    ***** 2013-10-29  Update 2015-2-12
┃　　　　　　　┃
┃　　　┻　　　┃
┃　　　　　　　┃
┗━┓　　　┏━┛
    ┃　　　┃  神兽保佑
    ┃　　　┃  代码无BUG！
    ┃　　　┗━━━┓
    ┃　　　　　　　┣┓
    ┃　　　　　　　┏┛
    ┗┓┓┏━┳┓┏┛
      ┃┫┫　┃┫┫
      ┗┻┛　┗┻┛    */
(function(f){if("object"!==typeof cyjh)throw"\u8bf7\u5148\u5f15\u7528cyjh\u57fa\u7840\u5e93";if("object"!==typeof cyjh.act){var c=function(){this._isLogin=!1;this.UserState=void 0;this._postState=[]},k={},p=function(a,b,e,r,c,q,g,h,m,n,l){if("string"!==typeof a||0===a.length)throw"sessionid\u5fc5\u987b\u662fstring (at) "+arguments.callee.caller;if("number"!==typeof g)throw"timeout\u5fc5\u987b\u662fnumber,\u4e0d\u8003\u8651\u8d85\u65f6\u8bf7\u586b0 (at) "+arguments.callee.caller;k[a]&&k[a].Abort();var d=this;this._sessionid=a;this._timeoutHandle=null;this._succCallback=q;this._actNotStartCallback=m;this._actExpiredCallback=n;this._failedCallback=l;this.IsDisposed=!1;this._ajaxObj=f.ajax(b,{type:e,dataType:c,data:r,success:function(a){if(cyjh.data.isObject(a)&&"number"===typeof a.ActState)switch(a.ActState){case 1:d._actNotStartCallback&&d._actNotStartCallback.call(window,a);d._dispose();d=null;break;case 2:d._actExpiredCallback&&d._actExpiredCallback.call(window,a);d._dispose();d=null;break;default:d._succCallback&&d._succCallback.call(window,a),d._dispose(),d=null}else d._succCallback&&d._succCallback.call(window,a),d._dispose(),d=null},error:function(a,b){0!==a.status&&12029!==a.status&&12027!==a.status&&0!==a.readyState&&"abort"!==a.statusText&&d._failedCallback&&d._failedCallback.call(a,b);d._dispose();d=null}});k[a]=this;0<g&&(this._timeoutCallback=h,this._timeoutHandle=window.setTimeout(function(){d._timeoutCallback&&d._timeoutCallback.call(window);d.Abort();d=null},1E3*g))};p.prototype._dispose=function(){this.IsDisposed||(this._sessionid&&k[this._sessionid]&&delete k[this._sessionid],delete this._sessionid,delete this._ajaxObj,"number"===typeof this._timeoutHandle&&window.clearTimeout(this._timeoutHandle),delete this._timeoutHandle,delete this._succCallback,delete this._actNotStartCallback,delete this._actExpiredCallback,delete this._failedCallback,delete this._timeoutCallback,this.IsDisposed=!0)};p.prototype.Abort=function(){this._ajaxObj&&(this._ajaxObj.abort(),delete this._ajaxObj);this._dispose()};c.prototype.GetJSON=function(a,b,e,r,f,q,g,h,m,c){return new p(a,b,"get",e,r?"json":"text",f,q,g,h,m,c)};c.prototype.PostJSON=function(a,b,e,f,c,q,g,h,m,n){return new p(a,b,"post",e,f?"json":"text",c,q,g,h,m,n)};c.prototype.GetJSONP=function(a,b,e,f,c,q,g,h,m){return new p(a,b,"get",e,"jsonp",f,c,q,g,h,m)};c.prototype.IsLogin=function(){var a=arguments.length;if(1!==a&&2!==a||"boolean"!==typeof arguments[0])return this._isLogin;var b=arguments[0],e=this.UserState;this.UserState=b&&2===a?arguments[1]:void 0;if(this._isLogin!=b||e!==this.UserState){this._isLogin=b;for(var f in this._postState)a=this._postState[f],"function"===typeof a&&a.call(window,b,this.UserState)}};c.prototype.CheckLogin=function(){if(this._isLogin)return!0;this.OpenLoginForm();return!1};c.prototype.AddUserStateHandler=function(a){if("function"===typeof a){for(var b in this._postState)if(this._postState[b]===a)return;this._postState.push(a);a.call(window,this._isLogin,this.UserState)}};c.prototype.RemoveUserStateHandler=function(a){if("function"!==typeof a)return!1;var b=-1,e;for(e in this._postState)if(this._postState[e]===a){b=e;break}return-1!=b?(this._postState.splice(b,1),!0):!1};c.prototype.OpenLoginForm=function(){};cyjh.act=new c;var s=function(a){var b=document.getElementsByTagName("head");if(0<b.length){var b=b[0],e=document.createElement("style");e.setAttribute("type","text/css");null==b.firstChild?b.appendChild(e):b.insertBefore(e,b.firstChild);e=document.styleSheets[0];if(null!=e.cssRules&&null!=e.insertRule)for(var f in a)b=a[f],b=b[0]+"{"+b[1]+"}",e.insertRule(b,e.cssRules.length);else if(null!=e.addRule)for(f in a)b=a[f],e.addRule(b[0],b[1],-1)}};(function(){var a=[];cyjh.browser.isie6&&a.push(["body","background-image:url('about:blank'); background-attachment:fixed"],[".filterIE6BG___","position:absolute;top:expression(eval(document.documentElement.scrollTop));"]);0!==a.length&&s(a);a=null;(function(){var a=1,e=39999,r=function(){var a=f(this),b=a.data("data-pop");if(cyjh.data.isObject(b))for(var e in b){var c=b[e];"function"===typeof c.onCloseCallback&&c.onCloseCallback.call(window,c.onCloseCallbackState);c.Close()}a.removeData("data-pop").unbind("click",arguments.callee)},k=function(c,g,h,m,n,l){var d=f(c);if(0==d.length)this.IsClosed=!0;else{this.IsClosed=!1;var k=f(g);!cyjh.data.isNotEmptyStr(n)&&(n="#000");("number"!==typeof l||0>l||100<l)&&(l=90);c=e+=2;g=d.attr("data-popid")||"__PopboxAutoId"+a++;var p=k.data("data-pop")||{};p[g]=this;this._popId=g;this._box=d;this.onCloseCallback=h;this.onCloseCallbackState=m;k.unbind("click",r).bind("click",r).data("data-pop",p);0<l&&(h=f("#"+g),0===h.length&&(h=f(document.createElement("div")),h.appendTo(document.body)),h.prop("id",g),cyjh.browser.isie6?(h.addClass("filterIE6BG___"),h.css({top:0,left:0,width:"100%",height:"100%",opacity:l/100,backgroundColor:n,display:"block","z-index":c})):h.css({position:"fixed",top:0,left:0,width:"100%",height:"100%",opacity:l/100,backgroundColor:n,display:"block","z-index":c}));d.attr("data-popid",g);window.addEventListener?(d.css({position:"fixed",top:"-10000px",left:"-10000px",display:"block","z-index":c+1}),d.css({top:"calc((100% - "+d.height()+"px) / 2)",left:"calc((100% - "+d.width()+"px) / 2)"})):(cyjh.browser.isie6?(d.css({position:"absolute",top:"-10000px",left:"-10000px",display:"block","z-index":c+1}),this._resize=function(){var a=arguments.callee,b=a.boxer,c=f(window);b&&b._box?(b._box.css({top:document.documentElement.scrollTop+(c.height()-d.height())/2,left:document.documentElement.scrollLeft+(c.width()-d.width())/2}),cyjh.browser.isie6&&f("#"+b._popId).height(c.height())):c.unbind("resize",a)},this._resize.boxer=this,f(window).bind("resize",this._resize),f(window).bind("scroll",this._resize)):(d.css({position:"fixed",top:"-10000px",left:"-10000px",display:"block","z-index":c+1}),this._resize=function(){var a=arguments.callee,b=a.boxer,c=f(window);b&&b._box?b._box.css({top:(c.height()-d.height())/2,left:(c.width()-d.width())/2}):c.unbind("resize",a)},this._resize.boxer=this,f(window).bind("resize",this._resize)),this._resize())}};k.prototype.Close=function(){!this.IsClosed&&this._box&&(f("#"+this._popId).hide(),this._box.hide(),delete this._box,delete this._popId,delete this.onCloseCallback,delete this.onCloseCallbackState,this._resize&&(delete this._resize.boxer,cyjh.browser.isie6?f(window).unbind("resize",this._resize).unbind("scroll",this._resize):f(window).unbind("resize",this._resize),delete this._resize),this.IsClosed=!0)};c.prototype.PopBox=function(a,b,c,e,f,l){return new k(a,b,c,e,f,l)}})()})()}})(jQuery);